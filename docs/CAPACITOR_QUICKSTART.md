# ğŸš€ Capacitor Android åŒ– å®Ÿè¡Œæ‰‹é †

## âœ… ç¾åœ¨ã®çŠ¶æ³

- âœ… Capacitor ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«æ¸ˆã¿ (`@capacitor/core`)
- âœ… Next.js ãƒ“ãƒ«ãƒ‰æˆåŠŸ
- âœ… API Routes ç¶­æŒï¼ˆ`output: "export"`ã¯æœªä½¿ç”¨ï¼‰

---

## ğŸ“‹ æ¬¡ã®ã‚¹ãƒ†ãƒƒãƒ—

### ã‚¹ãƒ†ãƒƒãƒ— 1: Android ãƒ—ãƒ©ãƒƒãƒˆãƒ•ã‚©ãƒ¼ãƒ ã‚’è¿½åŠ 

```bash
npm install @capacitor/android
npm run cap:add:android
```

ã“ã‚Œã«ã‚ˆã‚Š`android/`ãƒ‡ã‚£ãƒ¬ã‚¯ãƒˆãƒªãŒä½œæˆã•ã‚Œã¾ã™ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 2: capacitor.config.ts ã‚’ç’°å¢ƒã«åˆã‚ã›ã¦ä¿®æ­£

ç¾åœ¨ã®è¨­å®š:

```typescript
server: {
  url: "http://192.168.1.64:3000", // â† ã‚ãªãŸã®ãƒ­ãƒ¼ã‚«ãƒ«IPã«å¤‰æ›´
  cleartext: true,
}
```

**ã‚ãªãŸã®ãƒ­ãƒ¼ã‚«ãƒ« IP ã‚’ç¢ºèª:**

PowerShell ã§:

```powershell
ipconfig
```

`IPv4 ã‚¢ãƒ‰ãƒ¬ã‚¹`ã‚’`capacitor.config.ts`ã®`url`ã«è¨­å®šã—ã¦ãã ã•ã„ã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 3: Next.js ã‚µãƒ¼ãƒãƒ¼ã‚’èµ·å‹•

åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§:

```bash
npm run dev
# ã¾ãŸã¯æœ¬ç•ªãƒ“ãƒ«ãƒ‰å¾Œ
npm run build
npm start
```

ã‚µãƒ¼ãƒãƒ¼ãŒ`http://localhost:3000`ã§èµ·å‹•ã—ã¦ã„ã‚‹ã“ã¨ã‚’ç¢ºèªã€‚

### ã‚¹ãƒ†ãƒƒãƒ— 4: Android ãƒ“ãƒ«ãƒ‰

```bash
npm run android:dev
```

ã“ã‚Œã¯ä»¥ä¸‹ã‚’å®Ÿè¡Œã—ã¾ã™:

1. `npm run build` - Next.js ãƒ“ãƒ«ãƒ‰
2. `cap sync` - Capacitor ã¨ Android ã®åŒæœŸ
3. `cap open android` - Android Studio ã‚’é–‹ã

### ã‚¹ãƒ†ãƒƒãƒ— 5: Android Studio ã§ãƒ“ãƒ«ãƒ‰

Android Studio ãŒé–‹ã„ãŸã‚‰:

1. **Gradle åŒæœŸã‚’å¾…ã¤** (åˆå›ã¯æ™‚é–“ãŒã‹ã‹ã‚Šã¾ã™)
2. **ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã‚’èµ·å‹•** ã¾ãŸã¯ **å®Ÿæ©Ÿã‚’æ¥ç¶š**
3. **Run (â–¶)** ãƒœã‚¿ãƒ³ã‚’ã‚¯ãƒªãƒƒã‚¯

---

## ğŸ¯ å‹•ä½œç¢ºèª

### ã‚¢ãƒ—ãƒªèµ·å‹•å¾Œã®ç¢ºèªé …ç›®

1. âœ… ã‚¢ãƒ—ãƒªãŒèµ·å‹•ã™ã‚‹
2. âœ… ãƒˆãƒƒãƒ—ãƒšãƒ¼ã‚¸ãŒè¡¨ç¤ºã•ã‚Œã‚‹
3. âœ… ãƒ†ã‚¹ãƒˆä¸€è¦§ãŒè¡¨ç¤ºã•ã‚Œã‚‹ï¼ˆAPI ã‹ã‚‰å–å¾—ï¼‰
4. âœ… ãƒ•ã‚©ãƒ«ãƒ€ãƒ•ã‚£ãƒ«ã‚¿ãŒå‹•ä½œã™ã‚‹
5. âœ… æ¤œç´¢ãŒå‹•ä½œã™ã‚‹
6. âœ… ãƒ†ã‚¹ãƒˆè©³ç´°ãŒè¡¨ç¤ºã•ã‚Œã‚‹
7. âœ… PDF è¡¨ç¤ºãŒå‹•ä½œã™ã‚‹

### ãƒˆãƒ©ãƒ–ãƒ«ã‚·ãƒ¥ãƒ¼ãƒ†ã‚£ãƒ³ã‚°

#### å•é¡Œ: ã‚¢ãƒ—ãƒªãŒçœŸã£ç™½

**åŸå› :** Next.js ã‚µãƒ¼ãƒãƒ¼ãŒèµ·å‹•ã—ã¦ã„ãªã„

**è§£æ±ºç­–:**

```bash
# åˆ¥ã®ã‚¿ãƒ¼ãƒŸãƒŠãƒ«ã§
npm run dev
```

#### å•é¡Œ: "æ¥ç¶šã§ãã¾ã›ã‚“"ã‚¨ãƒ©ãƒ¼

**åŸå› :** ãƒ­ãƒ¼ã‚«ãƒ« IP ãŒé–“é•ã£ã¦ã„ã‚‹

**è§£æ±ºç­–:**

1. `ipconfig`ã§ IP ã‚’ç¢ºèª
2. `capacitor.config.ts`ã®`url`ã‚’ä¿®æ­£
3. `npm run cap:sync`ã‚’å†å®Ÿè¡Œ

#### å•é¡Œ: "Cleartext HTTP traffic not permitted"

**è§£æ±ºç­–:** `android/app/src/main/AndroidManifest.xml`ã‚’ç·¨é›†

```xml
<application
    android:usesCleartextTraffic="true"
    ...>
```

---

## ğŸ“± æœ¬ç•ªãƒ“ãƒ«ãƒ‰æ‰‹é †

### APK ãƒ•ã‚¡ã‚¤ãƒ«ç”Ÿæˆ

1. **æœ¬ç•ªãƒ“ãƒ«ãƒ‰**

   ```bash
   npm run build
   npm run cap:sync
   ```

2. **Android Studio ã§ãƒ“ãƒ«ãƒ‰**

   - `Build` â†’ `Build Bundle(s) / APK(s)` â†’ `Build APK(s)`
   - ç”Ÿæˆã•ã‚ŒãŸ APK ã¯`android/app/build/outputs/apk/debug/`ã«ä¿å­˜

3. **ç½²åä»˜ã APKï¼ˆãƒªãƒªãƒ¼ã‚¹ç”¨ï¼‰**
   - `Build` â†’ `Generate Signed Bundle / APK`
   - ã‚­ãƒ¼ã‚¹ãƒˆã‚¢ã‚’ä½œæˆï¼ˆåˆå›ã®ã¿ï¼‰
   - ãƒ‘ã‚¹ãƒ¯ãƒ¼ãƒ‰ã¨ã‚¨ã‚¤ãƒªã‚¢ã‚¹ã‚’è¨­å®š

---

## ğŸ”§ é«˜åº¦ãªè¨­å®š

### webDir ã‚’å¤‰æ›´ã™ã‚‹å ´åˆ

**ç¾åœ¨ã®è¨­å®š:**

```typescript
webDir: ".next/standalone/public",
```

**é™çš„ã‚¨ã‚¯ã‚¹ãƒãƒ¼ãƒˆã™ã‚‹å ´åˆ:**

1. `next.config.ts`ã‚’ä¿®æ­£:

   ```typescript
   output: "export",
   ```

2. `capacitor.config.ts`ã‚’ä¿®æ­£:

   ```typescript
   webDir: "out",
   ```

3. API Routes ã‚’å¤–éƒ¨ API ã«åˆ‡ã‚Šæ›¿ãˆï¼ˆåˆ¥ã‚µãƒ¼ãƒãƒ¼å¿…è¦ï¼‰

### ã‚ªãƒ•ãƒ©ã‚¤ãƒ³å¯¾å¿œ

Service Worker ã¨ IndexedDB ã‚’å®Ÿè£…:

```bash
npm install workbox-webpack-plugin
npm install dexie
```

---

## ğŸ“Š ã‚¢ãƒ¼ã‚­ãƒ†ã‚¯ãƒãƒ£å›³

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Androidã‚¢ãƒ—ãƒª (WebView)            â”‚
â”‚   - Capacitor                       â”‚
â”‚   - HTML/CSS/JavaScript             â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
               â”‚ HTTP (192.168.1.64:3000)
               â–¼
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚   Next.jsã‚µãƒ¼ãƒãƒ¼ (é–‹ç™ºPC)           â”‚
â”‚   - API Routes                      â”‚
â”‚   - SQLite Database                 â”‚
â”‚   - ãƒ•ã‚¡ã‚¤ãƒ«ã‚¹ãƒˆãƒ¬ãƒ¼ã‚¸                â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

---

## âœ… ãƒã‚§ãƒƒã‚¯ãƒªã‚¹ãƒˆ

### é–‹ç™ºç’°å¢ƒã‚»ãƒƒãƒˆã‚¢ãƒƒãƒ—

- [x] `@capacitor/core`ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [x] `@capacitor/cli`ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [x] `npx cap init`å®Ÿè¡Œ
- [ ] `@capacitor/android`ã‚¤ãƒ³ã‚¹ãƒˆãƒ¼ãƒ«
- [ ] `npm run cap:add:android`å®Ÿè¡Œ
- [ ] `capacitor.config.ts`ã® IP ã‚¢ãƒ‰ãƒ¬ã‚¹è¨­å®š
- [ ] Next.js ã‚µãƒ¼ãƒãƒ¼èµ·å‹•ç¢ºèª

### ãƒ“ãƒ«ãƒ‰ã¨ãƒ‡ãƒ—ãƒ­ã‚¤

- [x] `npm run build`æˆåŠŸ
- [ ] `npm run cap:sync`å®Ÿè¡Œ
- [ ] Android Studio ã§é–‹ã
- [ ] ã‚¨ãƒŸãƒ¥ãƒ¬ãƒ¼ã‚¿ãƒ¼ã§å‹•ä½œç¢ºèª
- [ ] å®Ÿæ©Ÿã§å‹•ä½œç¢ºèª

### æ©Ÿèƒ½ãƒ†ã‚¹ãƒˆ

- [ ] ã‚¢ãƒ—ãƒªèµ·å‹•
- [ ] ãƒ†ã‚¹ãƒˆä¸€è¦§è¡¨ç¤º
- [ ] æ¤œç´¢æ©Ÿèƒ½
- [ ] ãƒ•ã‚£ãƒ«ã‚¿æ©Ÿèƒ½
- [ ] ãƒ†ã‚¹ãƒˆè©³ç´°è¡¨ç¤º
- [ ] PDF è¡¨ç¤º
- [ ] æ–°è¦ä½œæˆ
- [ ] ç·¨é›†

---

## ğŸ†˜ ã‚µãƒãƒ¼ãƒˆ

å•é¡ŒãŒç™ºç”Ÿã—ãŸå ´åˆ:

1. **Android Studio Logcat**ã‚’ç¢ºèª
2. **Chrome DevTools**ã§ãƒ‡ãƒãƒƒã‚° (`chrome://inspect`)
3. **Next.js ã‚µãƒ¼ãƒãƒ¼ãƒ­ã‚°**ã‚’ç¢ºèª

---

## ğŸ“š å‚è€ƒãƒªãƒ³ã‚¯

- [Capacitor å…¬å¼ãƒ‰ã‚­ãƒ¥ãƒ¡ãƒ³ãƒˆ](https://capacitorjs.com/docs)
- [Next.js with Capacitor](https://capacitorjs.com/docs/guides/nextjs)
- [Android é–‹ç™ºè€…ã‚¬ã‚¤ãƒ‰](https://developer.android.com/studio)

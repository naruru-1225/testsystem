# テスト管理システム 取扱説明書

**バージョン: 1.0**  
**最終更新日: 2025年10月29日**

---

## 📚 目次

1. [はじめに](#はじめに)
2. [システムの起動方法](#システムの起動方法)
3. [基本的な使い方](#基本的な使い方)
4. [テストの登録](#テストの登録)
5. [テストの検索・絞り込み](#テストの検索絞り込み)
6. [テストの編集・削除](#テストの編集削除)
7. [フォルダ管理](#フォルダ管理)
8. [ラベル(タグ)管理](#ラベルタグ管理)
9. [学年・科目の管理](#学年科目の管理)
10. [バックアップと復元](#バックアップと復元)
11. [よくある質問](#よくある質問)
12. [トラブルシューティング](#トラブルシューティング)

---

## はじめに

### このシステムについて

テスト管理システムは、学校のテスト問題をPDFファイルで保存・管理するためのシステムです。
テストをフォルダやラベルで整理したり、学年や科目で検索したりできます。

### 必要なもの

- パソコン (Windows, Mac, Linux)
- インターネットブラウザ (Google Chrome, Microsoft Edge, Safari など)
- システムがインストールされていること

---

## システムの起動方法

### 初回のみ: システムのビルド

**最初の1回だけ**、以下の手順でシステムをビルドします。

#### 手順1: フォルダを開く

1. デスクトップまたはエクスプローラーで、システムがインストールされているフォルダを開きます
2. フォルダ名: `test_app/1` (例: `F:\naruk\デスクトップ\app_dev\test_app\1`)

#### 手順2: PowerShellを開く

1. フォルダ内の何もない場所で、**Shiftキーを押しながら右クリック**
2. 「PowerShellウィンドウをここで開く」または「ターミナルで開く」を選択

#### 手順3: システムをビルド

PowerShellウィンドウで以下のコマンドを入力し、Enterキーを押します:

```powershell
npm run build
```

ビルドには1〜2分かかります。「Compiled successfully」と表示されたら完了です。

> **💡 ヒント**: ビルドは初回とシステム更新時のみ必要です。通常の使用時は不要です。

---

### 毎回の起動: サーバーの起動

#### 手順1: PowerShellを開く

1. システムフォルダ内で、**Shiftキーを押しながら右クリック**
2. 「PowerShellウィンドウをここで開く」または「ターミナルで開く」を選択

#### 手順2: 本番サーバーを起動

PowerShellウィンドウで以下のコマンドを入力し、Enterキーを押します:

```powershell
npm start
```

> **⚠️ 重要**: `npm run dev` ではなく `npm start` を使用してください

#### 手順3: ブラウザで開く

1. PowerShellに「Ready in ○○ms」と表示されたら起動完了です
2. ブラウザ(Google Chromeなど)を開きます
3. アドレスバーに以下を入力してEnterキーを押します:

```
http://localhost:3000
```

#### 手順4: 使用を開始

ブラウザにテスト一覧画面が表示されたら、使用を開始できます。

> **💡 ヒント**: システムを終了するには、PowerShellウィンドウで「Ctrl + C」を押します。

---

### 起動手順のまとめ

| タイミング | コマンド | 説明 |
|-----------|---------|------|
| **初回のみ** | `npm run build` | システムをビルド(1〜2分) |
| **毎回** | `npm start` | 本番サーバーを起動(数秒) |
| **終了時** | `Ctrl + C` | サーバーを停止 |

---

## 基本的な使い方

### メイン画面の構成

```
┌─────────────────────────────────────────────────────┐
│ ☰  [検索バー]  [ラベル選択]  [新規テスト登録]     │ ← ヘッダー
├──────────┬──────────────────────────────────────────┤
│          │  テスト名   科目   学年   所属   操作    │
│ フォルダ │  ─────────────────────────────────────   │
│ 一覧     │  数学中間   数学   中1    数学    👁編集  │ ← テスト一覧
│          │  期末試験   英語   中2    英語    👁編集  │
│ ラベル   │  ...                                      │
│ 一覧     │                                           │
│          │                                           │
│ カテゴリ │                                           │
└──────────┴──────────────────────────────────────────┘
```

#### ①ヘッダー
- **☰メニューボタン**: サイドバーを開閉します
- **検索バー**: キーワードでテストを検索します
- **ラベル選択**: ラベルでテストを絞り込みます
- **新規テスト登録ボタン**: 新しいテストを登録します

#### ②サイドバー(左側)
- **フォルダ一覧**: フォルダごとにテストを表示します
- **ラベル一覧**: ラベルごとにテストを表示します
- **カテゴリ**: 学年と科目の組み合わせで表示します
- **管理者メニュー**: システムの設定を変更します

#### ③テスト一覧(中央)
- 登録されているテストが一覧で表示されます
- 各行には、テスト名、科目、学年、所属フォルダ、操作ボタンが表示されます

---

## テストの登録

### 新しいテストを登録する

#### 手順1: 新規登録画面を開く

1. 画面右上の「**新規テスト登録**」ボタン(青色)をクリック

#### 手順2: テスト情報を入力

以下の情報を入力します:

| 項目 | 説明 | 必須 |
|------|------|------|
| **テスト名** | テストの名前(例: 2024年度 1学期 中間テスト) | ✅ 必須 |
| **科目** | ドロップダウンから選択 | ✅ 必須 |
| **学年** | ドロップダウンから選択 | ✅ 必須 |
| **説明** | テストについての補足説明 | 任意 |

#### 手順3: PDFファイルをアップロード

1. 「**メインPDFを選択**」ボタンをクリック
2. 登録したいPDFファイルを選択
3. ファイル名が表示されたら成功です

> **⚠️ 注意**: メインPDFは必ず1つ選択してください

#### 手順4: 添付PDFを追加(任意)

追加で関連資料をアップロードできます:

1. 「**添付PDFを選択**」ボタンをクリック
2. 追加したいPDFファイルを選択(複数選択可能)
3. 最大4つまで添付できます

> **💡 ヒント**: メインPDFと添付PDF合わせて最大5つまでアップロードできます

#### 手順5: フォルダを選択

1. 「所属フォルダ」欄でフォルダにチェックを入れます
2. 複数のフォルダを選択できます
3. 選択しない場合は「未分類」として扱われます

#### 手順6: ラベルを選択(任意)

1. 「ラベル」欄でラベルにチェックを入れます
2. 複数のラベルを選択できます

#### 手順7: 登録実行

1. すべての情報を入力したら「**登録**」ボタン(青色)をクリック
2. 「テストを登録しました」と表示されたら成功です
3. テスト一覧画面に戻ります

> **⚠️ 注意**: 
> - PDFファイルは1つ最大10MBまでです
> - アップロード中は画面を閉じないでください

---

## テストの検索・絞り込み

### 検索バーを使う

1. 画面上部の検索バーにキーワードを入力
2. テスト名、科目、学年、説明文から検索されます
3. 入力すると自動的に絞り込まれます

**検索例**:
- 「中間」と入力 → 「中間テスト」を含むテストが表示
- 「数学」と入力 → 科目が数学のテストが表示
- 「中1」と入力 → 学年が中1のテストが表示

### ラベルで絞り込む

1. 検索バーの右側にある「**すべてのラベル**」ドロップダウンをクリック
2. 絞り込みたいラベルを選択
3. そのラベルが付いているテストのみが表示されます
4. 「すべてのラベル」を選択すると絞り込みを解除できます

### フォルダで絞り込む

1. 左側のサイドバー「**フォルダ一覧**」からフォルダをクリック
2. そのフォルダに所属するテストのみが表示されます
3. フォルダに子フォルダがある場合、子フォルダのテストも含まれます
4. 「すべてのテスト」をクリックすると全テストが表示されます

### カテゴリで絞り込む

1. 左側のサイドバー「**カテゴリ**」から学年をクリック
2. その学年のテストが表示されます
3. さらに科目をクリックすると、学年と科目の両方で絞り込まれます

### 複数の絞り込みを組み合わせる

検索、ラベル、フォルダ、カテゴリは同時に使用できます:

**例**: 
- フォルダ「中間テスト」を選択
- ラベル「重要」を選択
- 検索バーに「数学」と入力
- → 結果: 「中間テスト」フォルダにあり、「重要」ラベルが付いた、「数学」を含むテストが表示

---

## テストの編集・削除

### テストを表示する

1. テスト一覧で見たいテストの「**👁(目のアイコン)**」をクリック
2. PDFプレビュー画面が開きます
3. PDFが複数ある場合は、上部のタブで切り替えられます
4. 「×」ボタンで閉じます

### テストを編集する

#### 手順1: 編集画面を開く

1. テスト一覧で編集したいテストの「**✏️編集**」ボタンをクリック

#### 手順2: 情報を変更

- テスト名、科目、学年、説明を変更できます
- フォルダやラベルの選択を変更できます
- PDFファイルは削除して新しくアップロードできます

#### 手順3: 保存

1. 変更が終わったら「**更新**」ボタンをクリック
2. 「テストを更新しました」と表示されたら成功です

### テストを削除する

#### 手順1: 削除ボタンをクリック

1. テスト一覧で削除したいテストの「**🗑️削除**」ボタンをクリック

#### 手順2: 確認

1. 「本当に削除しますか?」と確認メッセージが表示されます
2. **もう一度「削除」ボタンをクリック**すると完全に削除されます
3. キャンセルするには他の場所をクリックします

> **⚠️ 警告**: 削除したテストは復元できません(バックアップがある場合を除く)

---

## フォルダ管理

### 新しいフォルダを作成する

#### 手順1: 管理者メニューを開く

1. 左上の「**☰**」メニューボタンをクリック
2. サイドバー下部の「**管理者メニュー**」をクリック

#### 手順2: フォルダタブを選択

1. モーダルウィンドウが開きます
2. 「**フォルダ**」タブを選択(デフォルトで選択されています)

#### 手順3: フォルダを追加

1. 「フォルダ名」入力欄に新しいフォルダの名前を入力
2. 「**追加**」ボタンをクリック
3. フォルダ一覧に追加されます

### フォルダ名を変更する

1. フォルダ一覧で変更したいフォルダの「**✏️**」ボタンをクリック
2. 入力欄がアクティブになるので、新しい名前を入力
3. 「**💾(保存)**」ボタンをクリック

### フォルダを削除する

1. フォルダ一覧で削除したいフォルダの「**🗑️**」ボタンをクリック
2. 確認メッセージが表示されます

**ケース1: フォルダにテストが入っていない場合**
- 「削除」をクリックすると即座に削除されます

**ケース2: フォルダにテストが入っている場合**
- 「○件のテストが所属しています」と警告が表示されます
- 「**それでも削除**」をクリックすると、テストは「未分類」に移動し、フォルダが削除されます
- 「キャンセル」をクリックすると削除が中止されます

> **💡 ヒント**: フォルダを削除してもテストは削除されません

---

## ラベル(タグ)管理

### 新しいラベルを作成する

#### 手順1: 管理者メニューを開く

1. 左上の「**☰**」メニューボタンをクリック
2. 「**管理者メニュー**」をクリック

#### 手順2: ラベルタブを選択

1. 「**ラベル**」タブをクリック

#### 手順3: ラベルを追加

1. 「ラベル名」入力欄に新しいラベルの名前を入力
2. 色を選択(クリックして変更できます)
3. 「**追加**」ボタンをクリック

### ラベル名や色を変更する

1. ラベル一覧で変更したいラベルの「**✏️**」ボタンをクリック
2. 名前を変更したり、色を選択したりできます
3. 「**💾**」ボタンをクリックして保存

### ラベルを削除する

1. ラベル一覧で削除したいラベルの「**🗑️**」ボタンをクリック
2. 「削除」をクリックすると削除されます

> **⚠️ 注意**: ラベルを削除すると、そのラベルが付いているすべてのテストからラベルが外れます

---

## 学年・科目の管理

管理者メニューから、テスト登録時に使用する学年や科目を追加・編集できます。

### 学年を管理する

#### 手順1: 学年管理タブを開く

1. 「**☰**」→「**管理者メニュー**」を開く
2. 「**学年管理**」タブをクリック

#### 手順2: 学年を追加

1. 「学年名」入力欄に新しい学年を入力(例: 高3、小6)
2. 「**追加**」ボタンをクリック

#### 手順3: 学年を編集・削除

- **編集**: 「✏️」ボタンをクリックして名前を変更
- **削除**: 「🗑️」ボタンをクリック
  - その学年を使用しているテストがある場合は削除できません
  - エラーメッセージが表示されます

### 科目を管理する

#### 手順1: 科目管理タブを開く

1. 「**☰**」→「**管理者メニュー**」を開く
2. 「**科目管理**」タブをクリック

#### 手順2: 科目を追加

1. 「科目名」入力欄に新しい科目を入力(例: 化学、物理)
2. 「**追加**」ボタンをクリック

#### 手順3: 科目を編集・削除

- **編集**: 「✏️」ボタンをクリックして名前を変更
- **削除**: 「🗑️」ボタンをクリック
  - その科目を使用しているテストがある場合は削除できません

> **💡 ヒント**: 学年や科目を追加すると、テスト登録フォームのドロップダウンに自動的に反映されます

---

## バックアップと復元

大切なデータを保護するため、定期的にバックアップを作成することをおすすめします。

### バックアップを作成する

#### 手順1: 復元タブを開く

1. 「**☰**」→「**管理者メニュー**」を開く
2. 「**復元**」タブをクリック

#### 手順2: バックアップを作成

1. 「**バックアップ作成**」ボタン(青色)をクリック
2. ファイルのダウンロードが開始されます
3. ファイル名: `backup-YYYY-MM-DDTHH-MM-SS.db`

#### 手順3: バックアップファイルを保存

1. ダウンロードされたファイルを安全な場所に保存します
2. 推奨: 外部ドライブやクラウドストレージに保存

> **💡 推奨頻度**:
> - 毎週1回: 通常使用の場合
> - 毎日1回: 頻繁にテストを登録する場合
> - 重要な作業の前後: 大量のデータを入力・削除する前

### バックアップから復元する

#### 手順1: 復元タブを開く

1. 「**☰**」→「**管理者メニュー**」→「**復元**」タブ

#### 手順2: バックアップファイルを選択

1. 「バックアップから復元」セクションの「**ファイルを選択**」をクリック
2. 保存しておいたバックアップファイル(`.db`ファイル)を選択

#### 手順3: 復元するテストを選択

1. バックアップファイルの内容が表示されます
2. 復元したいテストにチェックを入れます
3. 「**すべて選択**」ボタンですべてのテストを選択できます

#### 手順4: 復元を実行

1. 「**選択したテストを復元**」ボタンをクリック
2. 確認メッセージが表示されます
3. 「OK」をクリックすると復元が開始されます
4. 「○件のテストを復元しました」と表示されたら成功です

> **⚠️ 注意**:
> - 復元すると、同じ名前のテストがある場合は上書きされません(新しいテストとして追加されます)
> - PDFファイルも復元されます

---

## よくある質問

### Q1: システムが起動しない

**A**: 以下を確認してください:
1. PowerShellで正しいフォルダにいるか確認
2. `npm start`を実行したか確認(初回は`npm run build`も必要)
3. エラーメッセージが表示されている場合は、[トラブルシューティング](#トラブルシューティング)を参照

### Q2: PDFが表示されない

**A**: 以下を試してください:
1. ブラウザを再読み込み(F5キーまたはCtrl+R)
2. PDFファイルが正しくアップロードされているか確認
3. PDFファイルが破損していないか確認

### Q3: テストが見つからない

**A**: 絞り込み設定を確認してください:
1. 検索バーをクリアする
2. ラベルフィルタを「すべてのラベル」に設定
3. サイドバーで「すべてのテスト」を選択

### Q4: アップロードできるファイルサイズは?

**A**: 1つのPDFファイルにつき最大10MBまでです。
- 合計で最大5つのPDFをアップロード可能(メイン1つ + 添付4つ)

### Q5: 間違えてテストを削除してしまった

**A**: バックアップがあれば復元できます:
1. 最新のバックアップファイルを用意
2. 管理者メニュー → 復元タブを開く
3. バックアップファイルから該当テストを復元

### Q6: 複数のパソコンで使用できますか?

**A**: 可能ですが、データベースファイルを共有する必要があります:
1. 同じネットワーク内であれば、IPアドレスでアクセス可能
2. PowerShellに表示される「Network: http://○○○○○」のアドレスを使用
3. ただし、同時編集には対応していません

### Q7: フォルダの順番を変更できますか?

**A**: 現在、自動で名前順に並びます。
- フォルダ名の先頭に番号を付けることで順序を制御できます
- 例: `1_中間テスト`、`2_期末テスト`

### Q8: 「未分類」フォルダとは?

**A**: フォルダを選択せずに登録したテストが自動的に入るフォルダです:
- テスト一覧の「所属」欄には表示されません
- 削除できません(システムが自動管理)
- 後からフォルダを選択して編集できます

---

## トラブルシューティング

### 問題: 「Port 3000 is in use」と表示される

**原因**: ポート3000が既に使用されています

**解決方法**:
1. 既存のサーバーを終了する:
   ```powershell
   Stop-Process -Name node -Force
   ```
2. または、別のポートを使用する(自動的に3001などが使用されます)

### 問題: 「Cannot find module」エラー

**原因**: 必要なパッケージがインストールされていません

**解決方法**:
```powershell
npm install
```
を実行してから、再度`npm run build`と`npm start`を実行

### 問題: PDFアップロードが失敗する

**原因**: 
- ファイルサイズが大きすぎる(10MB超)
- ファイル形式が正しくない

**解決方法**:
1. PDFファイルのサイズを確認(右クリック→プロパティ)
2. 10MB以下に圧縮してから再度アップロード
3. 拡張子が`.pdf`であることを確認

### 問題: 画面が真っ白

**原因**: JavaScriptエラーまたはブラウザの問題

**解決方法**:
1. ブラウザのキャッシュをクリア
   - Chrome: Ctrl+Shift+Delete → キャッシュをクリア
2. ブラウザを再起動
3. 別のブラウザで試す

### 問題: データが消えた

**原因**: データベースファイルが破損または削除された

**解決方法**:
1. バックアップファイルから復元
2. バックアップがない場合は、`data`フォルダを確認
3. `tests.db`ファイルが存在するか確認

### 問題: 動作が遅い

**原因**: データ量の増加またはPCのリソース不足

**解決方法**:
1. 不要なテストを削除
2. 古いバックアップファイルを整理
3. PCを再起動してメモリを解放
4. 他のアプリケーションを閉じる

### 問題: システムが終了できない

**原因**: プロセスが正常に終了していない

**解決方法**:
1. PowerShellで「Ctrl+C」を2回押す
2. それでも終了しない場合:
   ```powershell
   Stop-Process -Name node -Force
   ```

---

## お問い合わせ

システムについてご不明な点がございましたら、システム管理者にお問い合わせください。

---

**テスト管理システム v1.0**  
© 2025 All Rights Reserved
